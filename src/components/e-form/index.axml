<view class="pin absolute flex flex-col">
  <!-- 表单 -->
  <scroll-view scroll-y="{{true}}" class="flex-1 pt-3">
    <block a:for="{{bizObj}}" a:for-item="c" a:for-index="ci">
      <!-- 单行输入 -->
      <e-input a:if="{{c.component === 'e-input'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-input>
      <!-- 定位、地图 -->
      <e-address a:elif="{{c.component === 'e-address'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-address>
      <!-- 联级选择 -->
      <e-cascader a:elif="{{c.component === 'e-cascader'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-cascader>
      <!-- 日期时间选择 -->
      <e-date-picker a:elif="{{c.component === 'e-date-picker'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-date-picker>
      <!-- 部门选择 -->
      <e-dept-chooser a:elif="{{c.component === 'e-dept-chooser'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-dept-chooser>
      <!-- 下拉 -->
      <e-picker a:elif="{{c.component === 'e-picker'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-picker>
      <!-- 进度条 -->
      <e-progress-bar a:elif="{{c.component === 'e-progress-bar'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-progress-bar>
      <!-- 扫码 -->
      <e-scan a:elif="{{c.component === 'e-scan'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-scan>
      <!-- 跳转搜索 -->
      <e-search a:elif="{{c.component === 'e-search'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-search>
      <!-- 切换按钮 -->
      <e-switch a:elif="{{c.component === 'e-switch'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-switch>
      <!-- 多行输入 -->
      <e-text-area a:elif="{{c.component === 'e-text-area'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-text-area>
      <!-- 人员选择 -->
      <e-user-chooser a:elif="{{c.component === 'e-user-chooser'}}" model="{{c}}" onValidate="{{c.validate ? 'on_' + c.fid + '_' + c.key : undefined}}"></e-user-chooser>
      <!-- 子表组件 -->
      <view a:elif="{{c.component === 'e-subform'}}" class="mb-3">
        <!-- 子表 -->
        <block a:for="{{c.children}}" a:for-item="sf" a:for-index="sfi">
          <!-- 子表头部 -->
          <view class="flex items-center justify-between mb-3 ml-4 mr-2 {{sfi > 0 ? 'mt-3' : ''}}">
            <text class="color-sub-title text-xs">{{c.label}}-{{sfi + 1}}</text>
            <!-- 子表删除按钮 -->
            <view onTap="handleDelete" a:if="{{c.children.length > 1 && !c.disabled}}" data-sfi="{{sfi}}" data-c="{{c}}" class="color-primary text-xs">
              <text class="fa fa-trash mr-1"></text>删除
            </view>
          </view>
          <!-- 子表组件 -->
          <block a:for="{{sf}}" a:for-item="sc" a:for-index="sci">
            <e-input a:if="{{sc.component === 'e-input'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-input>
            <e-address a:elif="{{sc.component === 'e-address'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-address>
            <e-cascader a:elif="{{sc.component === 'e-cascader'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-cascader>
            <e-date-picker a:elif="{{sc.component === 'e-date-picker'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-date-picker>
            <e-dept-chooser a:elif="{{sc.component === 'e-dept-chooser'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-dept-chooser>
            <e-picker a:elif="{{sc.component === 'e-picker'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-picker>
            <e-progress-bar a:elif="{{sc.component === 'e-progress-bar'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-progress-bar>
            <e-scan a:elif="{{sc.component === 'e-scan'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-scan>
            <e-search a:elif="{{sc.component === 'e-search'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-search>
            <e-switch a:elif="{{sc.component === 'e-switch'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-switch>
            <e-text-area a:elif="{{sc.component === 'e-text-area'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-text-area>
            <e-user-chooser a:elif="{{sc.component === 'e-user-chooser'}}" model="{{sc}}" onValidate="{{sc.validate ? 'on_' + sc.fid + '_' + sc.key : undefined}}"></e-user-chooser>
          </block>
        </block>
        <!-- 子表增行按钮 -->
        <button a:if="{{!c.disabled}}" onTap="handleAdd" data-ci="{{ci}}" class="flex items-center justify-center bg-color-white color-primary border-none radius-none">
          <text class="text-2xl mr-1">+</text>添加{{c.label}}
        </button>
      </view>
    </block>
  </scroll-view>
  <view a:if="{{btns.length}}" class="flex flex-row bg-color-white relative border-top">
    <button a:if="{{btn.position === btnPos}}" a:for="{{btns}}" a:for-item="btn" data-btn="{{btn}}" onTap="handleBtn" class="border-none radius-none bg-opacity flex-1 text-lg flex items-center justify-center {{'btn-' + (btn.xtype || 'primary')}}">
      <text class="fa mr-1 {{'fa-' + btn.icon_cls}}"/>{{btn.action_name}}
    </button>
  </view>
</view>